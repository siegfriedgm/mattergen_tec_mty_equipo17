---
license: mit
license_link: https://opensource.org/license/mit

arxiv: 2312.03687
language:
- en
tags:
- materials-science
- generative-ai
- materials-discovery
---

# MatterGen

<!-- Provide a quick summary of what the model is/does. -->

MatterGen is a generative model for inorganic materials design.

## Model Details

### Model Description

<!-- Provide a longer summary of what this model is. -->

MatterGen is a generative model for inorganic materials design. It is a diffusion model which jointly predicts a material’s atomic fractional coordinates, elements, as well as unit cell lattice vectors. Besides unconditional generation of material candidates, MatterGen can also be trained or fine-tuned for conditional generation based on target property values, e.g., bulk modulus, chemical system, or magnetic density.

- **Developed by:** Materials Design Team, Microsoft Research AI for Science
- **Model type:** Diffusion model
- **License:** MIT

### Model Sources

<!-- Provide the basic links for the model. -->

- **Repository:** https://github.com/microsoft/mattergen
- **Paper:** https://arxiv.org/abs/2312.03687

## Uses

<!-- Address questions around how the model is intended to be used, including the foreseeable users of the model and those affected by the model. -->

### Direct Use

<!-- This section is for the model use without fine-tuning or plugging into a larger ecosystem/app. -->

1.	Generate inorganic materials candidates without property condition. 
2.	Fine-tune the base model on user-provided data with property-labeled materials.
3.	Generate inorganic materials candidates with target property, e.g., bulk modulus, chemical system, magnetic density, or user-defined target properties after fine-tuning.


### Out-of-Scope Use

<!-- This section addresses misuse, malicious use, and uses that the model will not work well for. -->

* Generate materials with more than 20 atoms inside the unit cell.
* Generate organic crystals or non-crystalline materials.
* Generate crystals containing noble gas elements, radioactive elements, or elements with atomic number greater than 84 – these elements were removed from the training data.

## Bias, Risks, and Limitations

<!-- This section is meant to convey both technical and sociotechnical limitations. -->

MatterGen was only trained on and evaluated on up to 20 atoms inside the unit cell; more atoms are currently not supported. MatterGen’s training data is materials below 0.1 eV/atoms below the reference convex hull. Therefore, it is expected that the fraction of generated materials on or below the convex hull is significantly lower than the fraction of materials within 0.1 eV/atom above the convex hull.


### Recommendations

<!-- This section is meant to convey recommendations with respect to the bias, risk, and technical limitations. -->

The performance on property-guided generation heavily depends on the quality and quantity of the property labels used to train MatterGen. For extreme property values where there are few training structures with similar values, the performance may degrade.

For fine-tuning the model on a new property, use a sufficient amount of labeled property data for training, i.e., at least several thousands of labeled structures. Also ensure good coverage of property values in the range of values which are intended for property-guided generation.

## How to Get Started with the Model

Clone the [repository](https://github.com/microsoft/mattergen) and follow the README instructions.

## Training Details

### Training Data

<!-- This should link to a Dataset Card, perhaps with a short stub of information on what the training data is all about as well as documentation related to data pre-processing or additional filtering. -->

MatterGen was trained on crystalline materials from the following data sources:
1.	MP (https://next-gen.materialsproject.org/; v2022.10.28, Creative Commons Attribution 4.0 International License), an open-access resource containing DFT-relaxed crystal structures obtained from a variety of sources, but largely based upon experimentally-known crystals.
2.	The Alexandria dataset (https://alexandria.icams.rub.de/; Creative Commons Attribution 4.0 International License), an open-access resource containing DFT-relaxed crystal structures from a variety of sources, including a large quantity of hypothetical crystal structures generated by ML methods or other algorithmic means.
To train MatterGen, we select only structures with up to 20 atoms and whose energy above hull is below 0.1 eV/atom. Further, we remove structures that contain noble gas elements, elements with atomic number higher than 84 (which includes most radioactive elements), or the radioactive elements “Tc” and “Pm” from the training data. For more information, see paper, Supplementary C.1.

### Training Procedure

<!-- This relates heavily to the Technical Specifications. Content here should link to that section when it is relevant to the training procedure. -->

#### Preprocessing 

We relax structures from the above data sources with DFT and select only those structures whose energy above the combined convex hull is below 0.1 eV/atom. MatterGen is trained solely on primitive structures. We further select only structures with up to 20 atoms inside the unit cell. We use the Niggli reduction to preprocess the unit cell lattices, followed by the polar decomposition to ensure the lattice matrices are symmetric matrices. See the paper for more detailed information.

#### Training Hyperparameters

* Starting learning rate 1e-4, reduces successively by a factor of 0.6 when training loss does not reduce within 100 epochs, up to 1e-6.
* Batch size 512
* float32 precision

#### Speeds, Sizes, Times 

<!-- This section provides information about throughput, start/end time, checkpoint size if relevant, etc. -->

* MatterGen contains 46.8M parameters
* One training epoch of around 600K training samples takes around 6 minutes on 8 NVIDIA A100 GPUs
* Sampling 1,000 structures takes around two hours using a single NVIDIA V100 GPU


## Evaluation

<!-- This section describes the evaluation protocols and provides the results. -->

### Testing Data, Factors & Metrics


#### Metrics

<!-- These are the evaluation metrics being used, ideally with a description of why. -->

MatterGen was evaluated on unconditional generation across the following metrics:
* The percentage of stable, novel, and unique (S.U.N.) structures among 1,024 generated samples. 
  - Stable means a structure’s energy is less than 0.1 eV/atom above the reference convex hull
  - Novel means a structure does not match any structure in our reference dataset with the disordered structure matcher presented in the paper.
  - Unique means that there is no other structure among the generated ones which matches a given structure.
* The average root mean square distance (RMSD) of generated structures and their DFT-relaxed local energy minima, measured in Angstrom.


### Results

MatterGen achieves 38.57 % S.U.N. rate among generated structures, and the average RMSD of its samples is 0.021 Angstrom. For more details see Section 2.2 of the MatterGen paper.
We also evaluate MatterGen on property-conditioned generation. 
•	For generation conditioned on chemical system, MatterGen produces 83 % S.U.N. structures on well-explored chemical systems, 65 % on partially explored systems, and 49 % on unexplored chemical systems. For more details, see Section 2.3 of the MatterGen paper.
•	Conditioning on a bulk modulus value of 400 GPa, MatterGen produces 106 S.U.N. structures with > 400 GPa bulk modulus given a budget of 180 DFT property calculations. For more details, see Section 2.4 of the MatterGen paper.
•	Conditioning on magnetic density of > 0.2 Angstrom-3, MatterGen produces 18 S.U.N. structures complying with the condition given a budget of 180 DFT property calculations. For more details, see Section 2.4 of the MatterGen paper.

#### Summary

MatterGen is able to produce novel, unique, and stable material candidates both with and without property conditions. For property-guided generation, MatterGen is able to produce S.U.N. structures with extreme property values such as 400 GPa bulk modulus, where there are only two such structures in the labeled reference set. MatterGen outperforms both classical as well as recent deep generative model baselines. For more details on the performance of MatterGen, see the paper.

## Technical Specifications 

### Model Architecture and Objective

The model architecture is based on GemNet (Gasteiger et al. 2021).

## Citation 

<!-- If there is a paper or blog post introducing the model, the APA and Bibtex information for that should go in this section. -->

**BibTeX:**
```bibtex
@article{zeni2023mattergen,
  title={Mattergen: a generative model for inorganic materials design},
  author={Zeni, Claudio and Pinsler, Robert and Z{\"u}gner, Daniel and Fowler, Andrew and Horton, Matthew and Fu, Xiang and Shysheya, Sasha and Crabb{\'e}, Jonathan and Sun, Lixin and Smith, Jake and others},
  journal={arXiv preprint arXiv:2312.03687},
  year={2023}
}
```

**APA:**

Zeni, C., Pinsler, R., Zügner, D., Fowler, A., Horton, M., Fu, X., ... & Xie, T. (2023). Mattergen: a generative model for inorganic materials design. arXiv preprint arXiv:2312.03687.


## Model Card Authors 

Daniel Zügner (dzuegner@microsoft.com)

## Model Card Contact

Daniel Zügner (dzuegner@microsoft.com)
Tian Xie (tianxie@microsoft.com)